// --- Localization Data ---
const translations = {
    en: {
        gallery: "Gallery",
        timerOff: "Timer: Off",
        timer3s: "Timer: 3s",
        timer5s: "Timer: 5s",
        snap: "Take Photo",
        filters: "Filters",
        settings: "Settings",
        language: "Language",
        debug: "Debug Info",
        fullscreen: "Full Screen",
        selectOverlay: "Select Overlay",
        galleryTitle: "Gallery",
        selectLanguage: "Select Language",
        debugTitle: "System Diagnostics",
        loading: "Loading...",
        emptyGallery: "Gallery is empty.",
        errorGallery: "Error loading images.",
        uploading: "Uploading...",
        pending: "Pending Uploads:",
        synced: "All synced",
        switchCamera: "Switch Camera",
        // Debug Labels
        lblRotation: "Orientation:",
        lblUserAgent: "User Agent:",
        lblBrowser: "Browser:",
        lblScreenRes: "Screen Res:",
        lblCamRes: "Camera Res:",
        lblCamCount: "Camera Count:",
        lblIp: "IP Address:"
    },
    es: {
        gallery: "GalerÃ­a",
        timerOff: "Temporizador: Apagado",
        timer3s: "Temporizador: 3s",
        timer5s: "Temporizador: 5s",
        snap: "Tomar Foto",
        filters: "Filtros",
        settings: "Ajustes",
        language: "Idioma",
        debug: "DepuraciÃ³n",
        fullscreen: "Pantalla Completa",
        selectOverlay: "Seleccionar Filtro",
        galleryTitle: "GalerÃ­a",
        selectLanguage: "Seleccionar Idioma",
        debugTitle: "DiagnÃ³stico del Sistema",
        loading: "Cargando...",
        emptyGallery: "La galerÃ­a estÃ¡ vacÃ­a.",
        errorGallery: "Error al cargar imÃ¡genes.",
        uploading: "Subiendo...",
        pending: "Subidas pendientes:",
        synced: "Todo sincronizado",
        switchCamera: "Cambiar CÃ¡mara",
        lblRotation: "OrientaciÃ³n:",
        lblUserAgent: "Agente de Usuario:",
        lblBrowser: "Navegador:",
        lblScreenRes: "Res. Pantalla:",
        lblCamRes: "Res. CÃ¡mara:",
        lblCamCount: "Num. CÃ¡maras:",
        lblIp: "DirecciÃ³n IP:"
    },
    fr: {
        gallery: "Galerie",
        timerOff: "Minuteur: DÃ©sactivÃ©",
        timer3s: "Minuteur: 3s",
        timer5s: "Minuteur: 5s",
        snap: "Prendre Photo",
        filters: "Filtres",
        settings: "ParamÃ¨tres",
        language: "Langue",
        debug: "DÃ©bogage",
        fullscreen: "Plein Ã‰cran",
        selectOverlay: "Choisir un Filtre",
        galleryTitle: "Galerie",
        selectLanguage: "Choisir la Langue",
        debugTitle: "Diagnostic SystÃ¨me",
        loading: "Chargement...",
        emptyGallery: "La galerie est vide.",
        errorGallery: "Erreur de chargement.",
        uploading: "TÃ©lÃ©chargement...",
        pending: "En attente:",
        synced: "SynchronisÃ©",
        switchCamera: "Changer de camÃ©ra",
        lblRotation: "Orientation:",
        lblUserAgent: "User Agent:",
        lblBrowser: "Navigateur:",
        lblScreenRes: "RÃ©s. Ã‰cran:",
        lblCamRes: "RÃ©s. CamÃ©ra:",
        lblCamCount: "Nb CamÃ©ras:",
        lblIp: "Adresse IP:"
    },
    qc: {
        gallery: "L'Album",
        timerOff: "Minuterie: Pantoute",
        timer3s: "Attends: 3s",
        timer5s: "Attends: 5s",
        snap: "PÃ¨se su'l piton!",
        filters: "Gugusses",
        settings: "Patentes",
        language: "Parlure",
        debug: "Le Bobo",
        fullscreen: "Gros Ã©cran",
        selectOverlay: "Choisis ta patente",
        galleryTitle: "Tes Kodaks",
        selectLanguage: "Choisis ta parlure",
        debugTitle: "KessÃ© qui marche pas?",
        loading: "Minute papillon...",
        emptyGallery: "Y'a rien pantoute!",
        errorGallery: "Ã‡a a plantÃ© solide.",
        uploading: "J'envoye Ã§a...",
        pending: "Ã‡a s'en vient:",
        synced: "C'est tiguidou!",
        switchCamera: "Virer le Kodak",
        lblRotation: "Bord:",
        lblUserAgent: "Moteur:",
        lblBrowser: "Fureteur:",
        lblScreenRes: "Grosseur d'Ã©cran:",
        lblCamRes: "Grosseur du Kodak:",
        lblCamCount: "Combien de Kodak:",
        lblIp: "Ton IP:"
    },
    de: {
        gallery: "Galerie",
        timerOff: "Timer: Aus",
        timer3s: "Timer: 3s",
        timer5s: "Timer: 5s",
        snap: "Foto aufnehmen",
        filters: "Filter",
        settings: "Einstellungen",
        language: "Sprache",
        debug: "Fehlersuche",
        fullscreen: "Vollbild",
        selectOverlay: "Overlay wÃ¤hlen",
        galleryTitle: "Galerie",
        selectLanguage: "Sprache wÃ¤hlen",
        debugTitle: "Systemdiagnose",
        loading: "Laden...",
        emptyGallery: "Galerie ist leer.",
        errorGallery: "Fehler beim Laden.",
        uploading: "Hochladen...",
        pending: "Ausstehend:",
        synced: "Alles synchronisiert",
        switchCamera: "Kamera wechseln",
        lblRotation: "Ausrichtung:",
        lblUserAgent: "User Agent:",
        lblBrowser: "Browser:",
        lblScreenRes: "Bildschirmaufl.:",
        lblCamRes: "Kameraaufl.:",
        lblCamCount: "Anzahl Kameras:",
        lblIp: "IP-Adresse:"
    },
    ja: {
        gallery: "ã‚®ãƒ£ãƒ©ãƒªãƒ¼",
        timerOff: "ã‚¿ã‚¤ãƒãƒ¼: ã‚ªãƒ•",
        timer3s: "ã‚¿ã‚¤ãƒãƒ¼: 3ç§’",
        timer5s: "ã‚¿ã‚¤ãƒãƒ¼: 5ç§’",
        snap: "å†™çœŸã‚’æ’®ã‚‹",
        filters: "ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼",
        settings: "è¨­å®š",
        language: "è¨€èª",
        debug: "ãƒ‡ãƒãƒƒã‚°",
        fullscreen: "å…¨ç”»é¢",
        selectOverlay: "ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤é¸æŠ",
        galleryTitle: "ã‚®ãƒ£ãƒ©ãƒªãƒ¼",
        selectLanguage: "è¨€èªã‚’é¸æŠ",
        debugTitle: "ã‚·ã‚¹ãƒ†ãƒ è¨ºæ–­",
        loading: "èª­ã¿è¾¼ã¿ä¸­...",
        emptyGallery: "ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã¯ç©ºã§ã™ã€‚",
        errorGallery: "ç”»åƒã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ã€‚",
        uploading: "ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...",
        pending: "ä¿ç•™ä¸­:",
        synced: "åŒæœŸå®Œäº†",
        switchCamera: "ã‚«ãƒ¡ãƒ©åˆ‡ã‚Šæ›¿ãˆ",
        lblRotation: "å‘ã:",
        lblUserAgent: "UA:",
        lblBrowser: "ãƒ–ãƒ©ã‚¦ã‚¶:",
        lblScreenRes: "ç”»é¢è§£åƒåº¦:",
        lblCamRes: "ã‚«ãƒ¡ãƒ©è§£åƒåº¦:",
        lblCamCount: "ã‚«ãƒ¡ãƒ©æ•°:",
        lblIp: "IPã‚¢ãƒ‰ãƒ¬ã‚¹:"
    }
};

const supportedLanguages = [
    { code: 'en', name: 'English', flag: 'ğŸ‡ºğŸ‡¸' },
    { code: 'es', name: 'EspaÃ±ol', flag: 'ğŸ‡ªğŸ‡¸' },
    { code: 'fr', name: 'FranÃ§ais', flag: 'ğŸ‡«ğŸ‡·' },
    { code: 'qc', name: 'QuÃ©bÃ©cois', flag: 'âšœï¸' },
    { code: 'de', name: 'Deutsch', flag: 'ğŸ‡©ğŸ‡ª' },
    { code: 'ja', name: 'æ—¥æœ¬èª', flag: 'ğŸ‡¯ğŸ‡µ' }
];

// Initialize global state for language
let currentLang = localStorage.getItem('cwbLang') || 'en';

/**
 * Retrieves the translation for a specific key.
 * Falls back to English or the key itself if not found.
 */
function getTranslation(key) {
    if (!translations[currentLang] || !translations[currentLang][key]) {
        // Fallback to English
        return translations['en'][key] || key;
    }
    return translations[currentLang][key];
}